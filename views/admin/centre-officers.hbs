<div class="d-flex flex-column">
    {{>add_staff_form}}

    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-12">
                <div class="card mb-4">
                    <div class="card-header pb-0">
                        <h6>Vouchers table</h6>
                    </div>
                    <div class="card-body px-0 pt-0 pb-2">
                        <div class="table-responsive p-0">
                            <table id="voucherTable" class="table align-items-center mb-0">
                                <thead>
                                    <tr>
                                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                            Fullname</th>
                                        <th
                                            class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">
                                            Email</th>
                                        <th
                                            class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                            Gender</th>
                                        <th
                                            class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                            Date of birth</th>
                                        <th
                                            class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                                            Status</th>
                                    </tr>
                                </thead>
                                <tbody id="staffBodyTable">
                                    {{#each staffs}}
                                    <tr class="tr_in_table_in_location">
                                        <td>
                                            <div class="d-flex px-2 py-1">
                                                <div>
                                                    <img src="../../public/img/admin-nav/avatar.svg"
                                                        class="avatar avatar-sm me-3" alt="user1">
                                                </div>
                                                <div class="d-flex flex-column justify-content-center">
                                                    <h6 class="mb-0 text-sm">{{name}}</h6>
                                                    <p class="text-xs text-secondary mb-0">{{id}}</p>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <p class="text-xs font-weight-bold mb-0">{{email}}</p>
                                        </td>
                                        <td class="align-middle text-center">
                                            <span class="text-secondary text-xs font-weight-bold">{{gender}}</span>
                                        </td>
                                        <td class="align-middle text-center">
                                            <span class="text-secondary text-xs font-weight-bold">{{dob}}</span>
                                        </td>
                                        <td
                                            class="align-middle text-center text-sm justify-content-center align-items-center d-flex">
                                            <!-- <span class="badge badge-sm bg-gradient-success">Active</span> -->
                                            <select id="typeSelect" class="status-selected form-select w-70">
                                                <option value="12" {{active_check}}>Active</option>
                                                <option value="13" {{pending_check}}>Pending</option>
                                                <option value="14" {{blocked_check}}>Blocked</option>
                                            </select>
                                        </td>
                                    </tr>
                                    {{/each}}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="../../public/css/admin-voucher.css">

<script>

    table_headings = document.querySelectorAll("thead th");
    // Function to get voucher information from the form
    function getStaffInformation() {
        // Get input values
        var email = document.getElementById("email").value;
        var fullname = document.getElementById("fullname").value;
        var dob = document.getElementById("dob").value;
        var genderSelect = document.getElementById("gender");
        var gender = genderSelect.options[genderSelect.selectedIndex].value;

        // Create an object to hold the information
        var staff = {
            email: email,
            fullname: fullname,
            dob: dob,
            gender: gender,
        };

        return staff;
    }

    document.getElementById("voucherForm").addEventListener("submit", function (event) {
        event.preventDefault();

        var staff = getStaffInformation();
        console.log(staff);
        var tableBody = document.getElementById("voucherTableBody");
        var newRow = document.createElement("tr");
        newRow.classList.add("tr_in_table_in_location")
        var name = document.createElement("td");
        var email = document.createElement("td");
        email.classList.add("text-secondary", "font-weight-bold", "text-sm");
        var gender = document.createElement("td");
        gender.classList.add("align-middle", "text-center", "text-sm");
        var dob = document.createElement("td");
        dob.classList.add("align-middle", "text-center", "text-sm");
        var state = document.createElement("td");
        state.classList.add("align-middle", "text-center", "text-sm", "justify-content-center", "align-items-center", "d-flex");

        name.innerHTML = `
                <div class="d-flex px-2 py-1">
                    <div>
                        <img src="../assets/img/user_icon_011.jpg"
                            class="avatar avatar-sm me-3" alt="user1">
                    </div>
                    <div class="d-flex flex-column justify-content-center">
                        <h6 class="mb-0 text-sm">${staff.fullname}</h6>
                    </div>
                </div>
            `;

        newRow.appendChild(name);

        email.innerHTML = `
                <span class="text-secondary font-weight-bold">${staff.email}</span>
            `
        newRow.appendChild(email);

        if (staff.gender == "Female") {
            gender.innerHTML = `
                    <span class="text-secondary font-weight-bold">Female</span>
                `
        } else if (staff.gender == "Male") {
            gender.innerHTML = `
                    <span class="text-secondary font-weight-bold">Male</span>
                `
        }

        newRow.appendChild(gender)

        dob.innerHTML = `
               <span class="text-secondary font-weight-bold">${staff.dob}</span>
            `
        newRow.appendChild(dob);

        state.innerHTML = `
                <select id="typeSelect" class="status-selected form-select w-50"
                    aria-label="Default select example">
                    <option selected>Active</option>
                    <option value="1">Pending</option>
                    <option value="2">Blocked</option>
                </select>
            `
        newRow.appendChild(state);
        console.log(newRow.children)
        tableBody.appendChild(newRow);

        // Clear the form (optional)
        document.getElementById("voucherForm").reset();
    });

    table_headings = document.querySelectorAll("thead th");
    document.querySelector("#search_functionality").onsubmit = searchTable;

    function searchTable(event) {
        let table_rows = document.querySelectorAll("tbody .tr_in_table_in_location");
        const search = document.getElementById("input-search-hehe");
        event.preventDefault();
        table_rows.forEach((row, i) => {
            let table_data = row.textContent.toLowerCase(),
                search_data = search.value.toLowerCase();
            console.log(table_data);

            row.classList.toggle("hide", table_data.indexOf(search_data) < 0);
        });
    }

    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
        var options = {
            damping: '0.5'
        }
        Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
</script>